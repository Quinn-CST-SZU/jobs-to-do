## 1.prewhere代替where

> `prewhere`和`where`的作用相同，都用来过滤数据
>
> 不同之处在于`prewhere`只支持MergeTree族系列引擎的表
> 
> 提前过滤，降低io

```sql
-- 关闭prewhere转化，默认开启
set optimize_move_to_prewhere=0;

select pk,
    col1,
    col2,
    col3
from db.tbl
where col_filter = 'id_filter'

select pk,
    col1,
    col2,
    col3
from db.tbl
prewhere col_filter = 'id_filter'
```
某些场景，及时开启prewhere自动转化，系统也不会优化，需要手动指定prewhere

- 使用常量表达式

- 使用默认值为alias类型的字段

- 包含了arrayJoin，globalIn，globalNotIn或者indexHint的查询

- select查询的列字段和where的谓词相同

- 使用了主键（order by）字段

```sql
select uid from db.tbl where uid='hsd82gyd'
```

## 2.数据采样

> 通过采样运算可极大提升数据分析的性能
> 采样修饰符只在MergeTree engine表有效，且在创建表时需要指定采样策略

```sql
-- 抽样10%
select
    title,
    count(1) as pv
from db.tbl
where cid = 121
group by tags_01
order by pv desc
limit 1000
```
